<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:Task_worker_matching.ViewModels"
             x:Class="Task_worker_matching.Views.WorkerHome"
             x:DataType="vm:WorkerHomeViewModel"
             Width="800" Height="600"
             Background="#111827">

  <UserControl.DataContext>
    <vm:WorkerHomeViewModel/>
  </UserControl.DataContext>

  <Grid>
    <!-- rows/cols omitted for brevity -->

    <!-- Backdrop -->
    <Border Grid.Row="1" Grid.Column="1"
            Background="#1f2937"
            CornerRadius="25"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"/>

    <!-- Navigation Bar -->
    <StackPanel x:Name="NavPanel"
                Grid.Row="0" Grid.Column="1"
                Orientation="Horizontal"
                Spacing="10"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">
      <Button Content="Home" Command="{Binding NavigateHomeCommand}"/>
      <Button Content="My Offers" Command="{Binding NavigateMyOffersCommand}"/>
      <Button Content="Open Requests" Command="{Binding NavigateOpenRequestsCommand}"/>
      <Button Content="Task Execution" Command="{Binding NavigateExecutionCommand}"/>
      <Button Content="Questions" Command="{Binding NavigateQuestionsCommand}"/>
      <Button Content="Profile" Command="{Binding NavigateProfileCommand}"/>
      <Button Content="Log out" Command="{Binding LogoutCommand}"/>
    </StackPanel>

    <!-- Main Content -->
    <Border Grid.Row="1" Grid.Column="1"
            Background="Transparent"
            Padding="20"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch">
      <StackPanel Spacing="20" Margin="0,10,0,0">

        <!-- Heading -->
        <TextBlock Text="Worker Dashboard"
                   FontSize="16"
                   FontWeight="Bold"
                   Foreground="White"/>

        <!-- Stats Row -->
        <Grid ColumnSpacing="10">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <!-- Open Offers -->
          <Border Grid.Column="0" Style="{StaticResource StatCardStyle}">
            <StackPanel>
              <TextBlock Text="Open Offers" Foreground="White" FontSize="12"/>
              <TextBlock Text="{Binding OpenOffersCount}" Foreground="White" FontSize="24" FontWeight="Bold"/>
            </StackPanel>
          </Border>

          <!-- Assigned Tasks -->
          <Border Grid.Column="1" Style="{StaticResource StatCardStyle}">
            <StackPanel>
              <TextBlock Text="Assigned Tasks" Foreground="White" FontSize="12"/>
              <TextBlock Text="{Binding AssignedTasksCount}" Foreground="White" FontSize="24" FontWeight="Bold"/>
            </StackPanel>
          </Border>

          <!-- Rating -->
          <Border Grid.Column="2" Style="{StaticResource StatCardStyle}">
            <StackPanel Orientation="Horizontal" Spacing="4">
              <TextBlock Text="★" Foreground="#2563eb" FontSize="20"/>
              <TextBlock Text="{Binding Rating}" Foreground="White" FontSize="24" FontWeight="Bold"/>
            </StackPanel>
          </Border>

          <!-- Completion Rate -->
          <Border Grid.Column="3" Style="{StaticResource StatCardStyle}">
            <StackPanel>
              <TextBlock Text="Completion Rate" Foreground="White" FontSize="12"/>
              <TextBlock Text="{Binding CompletionRate, StringFormat={}{0:F0}%}" Foreground="White" FontSize="24" FontWeight="Bold"/>
            </StackPanel>
          </Border>
        </Grid>

        <!-- Private Requests Section -->
        <Border Background="#111827"
                BorderBrush="#425f9e"
                BorderThickness="1"
                CornerRadius="6"
                Padding="10">
          <StackPanel Spacing="10">
            <TextBlock Text="Private Requests" FontSize="14" FontWeight="Bold" Foreground="White"/>

            <!-- Search + Filter -->
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBox Width="300"
                       Background="#374151"
                       Foreground="White"
                       BorderBrush="Transparent"
                       Height="30"
                       Watermark="Search…"
                       Text="{Binding RequestSearchQuery, Mode=TwoWay}"/>
              <Button Content="Filter"
                      Command="{Binding FilterRequestsCommand}"
                      Background="#2563eb"
                      Foreground="White"
                      Padding="8,0"
                      BorderBrush="Transparent"/>
            </StackPanel>

            <!-- List of Requests -->
            <ScrollViewer Height="200">
              <ItemsControl Items="{Binding PrivateRequests}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate x:DataType="vm:RequestViewModel">
                    <Border Background="#1f2937" CornerRadius="6" Padding="10" Margin="0,4">
                      <Grid ColumnDefinitions="*,Auto">
                        <StackPanel>
                          <TextBlock Text="{Binding Title}" Foreground="White" FontWeight="Bold"/>
                          <TextBlock Text="{Binding Summary}" Foreground="LightGray" FontSize="11" Margin="0,4,0,0"/>
                        </StackPanel>
                        <Button Content="View Details"
                                Command="{Binding ViewDetailsCommand}"
                                Background="#2563eb"
                                Foreground="White"
                                Padding="8,4"
                                BorderBrush="Transparent"
                                HorizontalAlignment="Right"/>
                      </Grid>
                    </Border>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
            </ScrollViewer>

          </StackPanel>
        </Border>

      </StackPanel>
    </Border>
  </Grid>
</UserControl>
